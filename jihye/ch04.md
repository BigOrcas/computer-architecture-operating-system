# **Chapter 04 CPU와 작동 원리**

## 04-1 ALU와 제어장치

- CPU
    - ALU(계산)
    - 제어 장치(명령어를 읽고, 해석)
    - 레지스터(작은 임시 저장 장치)

### ALU

- 레지스터를 통해 **피연산자**를 받아들이고, 제어 장치로부터 수행할 연산을 알려주는 **제어 신호**를 받아들인다.
- 왜 ALU의 결과값을 메모리가 아닌 레지스터에 우선 저장할까?
    - CPU가 메모리에 접근하는 것보다 레지스터에 접근하는 속도가 훨씬 빠르기 때문
- ALU는 계산 결과와 더불어 **플래그(연산 결과에 대한 추가적인 상태 정보)**를 내보낸다.
    - 부호,제로,캐리,오버플로우,인터럽트,슈퍼파이버 플래그
        - 이러한 CPU는 프로그램을 실행하는 도중 반드시 기억해야 하는 일종의 참고 정보
        - 플래그 레지스터에 저장

> overflow?
> - 연산 결과가 연산 결과를 담을 레지스터보다 큰 상황

### 제어장치

- 제어 신호를 내보내고 명령어를 해석하는 부품
- 컴퓨터 부품들을 관리하고 작동시키기 위한 일종의 전기 신호

### 제어 장치가 받아들이는 정보

1. 클럭 신호
    - 컴퓨터의 모든 부품을 움직일 수 있게 하는 시간 단위
        - 클럭의 주기에 맞춰 한 레지스터에서 다른 레지스터로 데이터가 이동하거나, ALU에서 연산이 수행되거나, CPU가 메모리에 저장된 명령어를 읽어들인다.
2. 해석해야 할 명령어
    - CPU가 해석해야 할 명령어는 **명령어 레지스터** 라는 특별한 레지스터에 저장된다.
        - 제어 장치는 이 명령어 레지스터로부터 해석할 명령어를 받아들이고 해석한 뒤, 제어 신호를 발생시켜 컴퓨터 부품들에 수행해야 할 내용을 알려준다.
3. 플래그 레지스터 속 플래그 값
4. 시스템 버스, 그 중에서도 제어 버스로 전달된 제어신호

### 제어 장치가 내보내는 정보

- CPU 외부에 전달하는 제어 신호(== 제어 버스로 제어 신호를 내보낸다.)
    - 메모리로 전달
    - 입출력장치(보조기억장치)로 전달
- CPU 내부에 전달하는 제어 신호
    - ALU로 전달
        - 연산 지시 목적
    - 레지스터로 전달
        - 레지스터 간 데이터를 이동시키거나, 레지스터에 저장된 명령어를 해석하기 위해

## 04-2 레지스터

### 반드시 알아야 할 레지스터

- 프로그램 카운터
    - == 명령어 포인터
    - 메모리에서 읽어 들일 명령어의 주소를 저장한다.
- 명령어 레지스터
    - 메모리에서 읽어 들인 명령어를 저장하는 레지스터
- 메무리 주소 레지스터
    - 메모리 주소를 저장하는 레지스터
- 메모리 버퍼 레지스터
    - 메모리와 주고 받을 값(데이터와 명령어)을 저장하는 레지스터
- 플래그 레지스터
- 범용 레지스터
- 스택 포인터
- 베이스 레지스터

> CPU가 메모리 속 프로그램을 순차적으로 읽어 들이고 실행해 나갈 수 있는 이유는?
> - CPU 속 프로그램 카운터가 꾸준히 증가하기 때문


### 특정 레지스터를 이용한 주소 지정 방식(1): 스택 주소 지정 방식

- 스택과 스택 포인터를 이용한 주소 지정 방식
    - 스택 포인터란, 스택의 꼭대기를 가리키는 레지스터
        - 즉, 스택 마지막에 저장한 값의 위치를 저장한다.

> 메모리 안에 스택 영역이 있다.

### 특정 레지스터를 이용한 주소 지정 방식(2): 변위 주소 지정 방식

- 오퍼랜드 필드의 값(변위)과 특정 레지스터의 값을 더하여 유효 주소를 얻어내는 주소 지정 방식
- 오퍼랜드 필드의 주소와 어떤 레지스터를 더하는지에 따라 방식이 나뉜다.
    - 상대 주소 지정 방식
        - 오퍼랜드와 프로그램 카운터의 값을 더하여 유효 주소를 얻는 방식
        - 언제 사용될까?
            - 분기하여 특정 주소의 코드를 실행할 때
    - 베이스 레지스터 주소 지정 방식
        - 오퍼랜드(기준 주소와 떨어진 거리)와 베이스 레지스터(기준 주소)의 값을 더하여 유효 주소를 얻는 방식
        - 베이스 레지스터 속 기준 주소로부터 얼마나 떨어져 있는 주소에 접근할 것인지를 연산하여 유효 주소를 얻어내는 방식

> 명령어 = 연산 코드 + 오퍼랜드
> - 오퍼랜드 필드에는 메모리의 주소가 담길 때도 있다.

## 04-3 명령어 사이클과 인터럽트

### 명령어 사이클

- 하나의 명령어를 처리하는 정형화된 흐름을 명령어 사이클이라 한다.
- 프로그램 속 각각의 명령어들은 일정한 주기가 반복되며 실행되는데, 이 주기가 명령어 사이클이다.

### 인터럽트

- 간혹 명령어 사이클이 끊어지는 상황이 발생하는데 이를 인터럽트라 한다.
- 종류
    - 동기 인터럽트(예외, exception)
        - CPU에 의해 발생
    - 비동기 인터럽트(하드웨어 인터럽트)
        - 주로 입출력 장치에 의해 발생
        - 알림과 같은 인터럽트
        - 하드웨어 인터럽트를 이용하면 CPU는 주기적으로 완료 여부를 확인할 필요가 없다.
        - 입출력 작업 중에도 CPU로 하여금 효율적으로 명령어를 처리할 수 있게 한다.
        - 종류
            - 막을 수 있는 인터럽트
            - 막을 수 없는 인터럽트


---

### 내 생각
- 코드 한 줄, 한 줄 실행될 때마다 내부적으로 어떻게 돌아가는 건지 궁금하기도 했고 중요하다고 들었는데 대략적으론 알겠다. 

### 논의 내용
- 프로그램이 시작되는 과정에 대해서 각자 이해한만큼만 설명을 해보면 좋겠습니다.